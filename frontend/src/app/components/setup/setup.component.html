
<div
  class="obscurer"
  *ngIf="isFetching">
  <h3>Please wait ...</h3>
  <h4>Genius is thinking ...</h4>
  <mat-spinner
    mode="indeterminate"
    diameter="50"
    class="ajax-wait">
  </mat-spinner>
</div>

<div class="setup-wrapper">

  <div class="mat-elevation-z4 setup">

    <h2>Setup Magic</h2>

    <ol>
      <li>Select your database type</li>
      <li>Modify your database connection string. The connection string must have <code>{{ '{' }}database{{ '}' }}</code> as its database/initial-catalog</li>
      <li>Choose a root password</li>
    </ol>

    <mat-form-field
      class="database-type"
      *ngIf="jwtSecret !== null && jwtSecret.length >= 50">
      <mat-select
        placeholder="Select database type"
        [(ngModel)]="databaseType">
        <mat-option value="mysql">My SQL</mat-option>
        <mat-option value="mssql">Microsoft SQL server</mat-option>
      </mat-select>
    </mat-form-field>

    <mat-form-field
      *ngIf="jwtSecret !== null && jwtSecret.length >= 50 && databaseType === 'mssql'"
      class="connection-string">
      <input
        matInput
        placeholder="MS SQL connection string"
        type="text"
        [(ngModel)]="mssqlConnectionString">
    </mat-form-field>

    <mat-form-field
      *ngIf="jwtSecret !== null && jwtSecret.length >= 50 && databaseType === 'mysql'"
      class="connection-string">
      <input
        matInput
        placeholder="MySQL connection string"
        type="text"
        [(ngModel)]="mysqlConnectionString">
    </mat-form-field>

    <mat-form-field
      *ngIf="jwtSecret !== null && jwtSecret.length >= 50 && databaseType !== null"
      style="margin-right: 1rem;width: 20%;">
      <input
        matInput
        placeholder="Root password"
        type="password"
        [(ngModel)]="password">
    </mat-form-field>

    <mat-form-field
      *ngIf="jwtSecret !== null && jwtSecret.length >= 50 && databaseType !== null"
      style="margin-right: 1rem;width: 20%;">
      <input
        matInput
        placeholder="Repeat root password"
        type="password"
        [(ngModel)]="repeatPassword">
    </mat-form-field>

    <button
      *ngIf="checkConfig()"
      mat-raised-button
      style="min-width: 8rem;"
      color="primary"
      (click)="save()">
      Save
    </button>

  </div>

</div>
