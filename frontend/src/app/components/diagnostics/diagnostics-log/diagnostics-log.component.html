

<mat-card class="input">
  <div class="d-flex flex-sm-nowrap flex-wrap justify-content-between">
    <div class="d-flex align-items-center">
      <mat-card-title class="my-0">Log</mat-card-title>
      <div class="sm-icons">
        <button mat-icon-button [matMenuTriggerFor]="menu" class="mat-caption" matTooltip="Need help?">
          <mat-icon>help_outline</mat-icon>
        </button>
        <mat-menu #menu="matMenu">
          <div class="p-3">
            <p>
              Lorem ipsum dolor sit amet consectetur, adipisicing elit. Dolorem autem consequatur explicabo architecto sequi asperiores odit minima incidunt error facilis, animi eaque a pariatur magnam doloribus libero ad. Voluptatum, harum!
            </p>
          </div>
        </mat-menu>
      </div>
    </div>
  </div>
  <mat-card-subtitle>Lorem ipsum dolor sit amet consectetur adipisicing elit.</mat-card-subtitle>
  <span class="count">{{count}} items</span>

  <table
    mat-table
    [dataSource]="items"
    class="log-items clickable"
    multiTemplateDataRows>

    <ng-container matColumnDef="content">
      <td
        mat-cell
        *matCellDef="let el">{{el.content}}</td>
    </ng-container>

    <ng-container matColumnDef="type">
      <td
        class="mini-col"
        mat-cell
        *matCellDef="let el">{{el.type}}</td>
    </ng-container>

    <ng-container matColumnDef="when">
      <td
        class="mini-col"
        mat-cell
        *matCellDef="let el">{{el.created | since}}</td>
    </ng-container>

    <ng-container matColumnDef="show-details">

      <td
        mat-cell
        *matCellDef="let el"
        colspan="3">

        <div
          class="details-sheet"
          *ngIf="shouldDisplayDetails(el)">

          <span class="details-item">
            <strong>ID</strong>
            <span>{{el.id}}</span>
          </span>

          <span class="details-item">
            <strong>Created</strong>
            <span>{{el.created}}</span>
          </span>

          <span class="details-item">
            <strong>Type</strong>
            <span>{{el.type}}</span>
          </span>

          <span class="details-item full-width">
            <strong>Content</strong>
            <span class="pre-formatted copy" (click)="copyContent(el.content)">{{el.content}}</span>
          </span>

          <span *ngIf="el.meta" class="details-item full-width">
            <strong>Meta</strong>
            <span *ngFor="let idxMeta of toArray(el.meta)">
              <span>{{idxMeta.key}} - {{idxMeta.value}}</span>
            </span>
          </span>

          <span *ngIf="el.exception" class="details-item full-width">
            <strong>Exception</strong>
            <span class="pre-formatted copy" (click)="copyContent(el.exception)">{{el.exception}}</span>
          </span>

        </div>

      </td>

    </ng-container>

    <tr
      mat-row
      [ngClass]="(shouldDisplayDetails(el) ? 'selected ' + el.type : el.type) + ' log-row'"
      (click)="toggleDetails(el)"
      *matRowDef="let el; columns: displayedColumns;"></tr>

    <tr
      mat-row
      [ngClass]="shouldDisplayDetails(el) ? 'details' : 'invisible'"
      *matRowDef="let el; columns: ['show-details'];"></tr>

  </table>

  <button
    *ngIf="items.length !== count"
    mat-button
    class="more-btn"
    matTooltip="Retrieves next 20 items"
    (click)="feedMore()">
    More ...
  </button>
</mat-card>
