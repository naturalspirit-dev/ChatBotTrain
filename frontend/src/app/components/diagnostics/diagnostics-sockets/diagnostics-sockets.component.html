
<div class="wrapper">

  <div *ngIf="users.length === 0">
    No users are currently connected with backend over a Web Socket connection.
  </div>

  <div class="button-strip">

    <mat-form-field [class]="users.length > 0 ? 'fill-width' : 'invisible'" appearance="outline">

      <mat-label>Filter</mat-label>
      <input
        matInput
        type="text"
        autocomplete="off"
        [formControl]="filterFormControl">
      <mat-icon
        matSuffix
        *ngIf="filterFormControl.value.trim() !== ''"
        class="button"
        role="button"
        (click)="clearFilter()">clear</mat-icon>

    </mat-form-field>

  </div>

  <table
    mat-table
    [dataSource]="getFilteredUsers()"
    class="tests clickable"
    multiTemplateDataRows>

    <ng-container matColumnDef="name">
      <td mat-cell *matCellDef="let el">{{el.username}}</td>
    </ng-container>

    <ng-container matColumnDef="show-details">
      <td
        mat-cell
        *matCellDef="let el">

        <div
          class="details-sheet"
          *ngIf="shouldDisplayDetails(el)">

          <mat-chip-list>
            <mat-chip
              *ngFor="let con of el.connections"
              selectable="false">
              {{con}}
            </mat-chip>
          </mat-chip-list>

        </div>

      </td>
    </ng-container>

    <tr
      mat-row
      [ngClass]="(shouldDisplayDetails(el) ? 'selected ' : '') + 'user-row'"
      (click)="toggleDetails(el)"
      mat-row *matRowDef="let el; columns: ['name'];"></tr>

    <tr
      mat-row
      [ngClass]="shouldDisplayDetails(el) ? 'details' : 'invisible'"
      *matRowDef="let el; columns: ['show-details'];"></tr>

  </table>

</div>
