
/*
 * Manually created assumption that verifies the log works as expected.
 */
description:Assumes that we can query the log correctly
.lambda

   log.info:Assumption log item
   log.info:Assumption log itemXX
   log.capabilities

   // Verifying log implementation supports querying
   if:x:@log.capabilities/*/can-query
      log.query:Assumption log item
      if
         not
            mt
               get-count:x:@log.query/*
               .:int:0
         .lambda
            throw:Assumption failed, not enough items in log after storing log item
      log.get:x:@log.query/0/*/id
      log.query:Assumption log item
         from:x:./@log.query/0/*/id
         max:1
      if
         not
            eq
               get-count:x:@log.query/*
               .:int:1
         .lambda
            throw:Assumption failed, not correct number of items returned from querying log

   // Verifying log implementation supports timeshifts
   if:x:@log.capabilities/*/can-timeshift
      log.timeshift:Assumption log item
      if
         not
            eq
               get-count:x:@log.timeshift/*
               .:int:14
         .lambda
            throw:Assumption failed, not correct number of items returned from timeshift
