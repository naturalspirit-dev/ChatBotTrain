
<mat-card class="public-key" *ngIf="publicKeyFull">

  <h3>Server key</h3>

  <span class="details-item">
    <strong>Fingerprint</strong><span>{{publicKeyFull.fingerprint}}</span>
  </span>

  <span class="details-item">
    <strong>Fingerprint format</strong><span>{{publicKeyFull.fingerprintFormat}}</span>
  </span>

  <span class="details-item">
    <strong>Key format</strong><span>{{publicKeyFull.keyFormat}}</span>
  </span>

  <span class="details-item">
    <strong>Key type</strong><span>{{publicKeyFull.keyType}}</span>
  </span>

  <span class="details-item">
    <textarea
      class="key"
      matTooltip="Public key"
      rows="10">{{publicKeyFull.publicKey}}</textarea>
  </span>


</mat-card>

<mat-card>

  <table
    mat-table
    [dataSource]="publicKeys"
    class="keys clickable"
    multiTemplateDataRows>

    <ng-container matColumnDef="subject">
      <td
        mat-cell
        *matCellDef="let el">{{el.key.subject}}</td>
    </ng-container>

    <ng-container matColumnDef="email">
      <td
        mat-cell
        *matCellDef="let el">{{el.key.email}}</td>
    </ng-container>

    <ng-container matColumnDef="delete">
      <td mat-cell class="minimalistic-col" *matCellDef="let el">
        <button
          mat-icon-button
          matTooltip="Delete"
          (click)="delete($event, el.key)">
          <mat-icon>delete</mat-icon>
        </button>
      </td>
    </ng-container>

    <ng-container matColumnDef="show-details">

      <td
        mat-cell
        *matCellDef="let el"
        class="details-column"
        colspan="3">

        <div *ngIf="shouldDisplayDetails(el)">

          <span class="details-item">
            <strong>ID</strong><span>{{el.key.id}}</span>
          </span>

          <span class="details-item">
            <strong>Subject</strong><span>{{el.key.subject}}</span>
          </span>

          <span class="details-item">
            <strong>Email</strong><span>{{el.key.email}}</span>
          </span>

          <span class="details-item">
            <strong>Domain</strong><span>{{el.key.domain}}</span>
          </span>

          <span class="details-item">
            <strong>Fingerprint</strong><span>{{el.key.fingerprint}}</span>
          </span>

          <span class="details-item">
            <strong>Imported</strong><span>{{el.key.imported | date}}</span>
          </span>

          <span class="details-item">
            <strong>Type</strong><span>{{el.key.type}}</span>
          </span>

          <span class="details-item">
            <strong>Enabled</strong><span>{{el.key.enabled}}</span>
          </span>

          <span class="details-item">
            <textarea
              class="key"
              matTooltip="Public key"
              rows="10">{{el.key.content}}</textarea>
          </span>

          <span class="details-item">
            <app-codemirror-hyperlambda [(model)]="el.options"></app-codemirror-hyperlambda>
          </span>

        </div>

      </td>

    </ng-container>

    <tr
      mat-row
      [ngClass]="(shouldDisplayDetails(el) ? 'selected ' : '') + 'key-row'"
      (click)="toggleDetails(el)"
      *matRowDef="let el; columns: displayedColumns;"></tr>

    <tr
      mat-row
      [ngClass]="shouldDisplayDetails(el) ? 'details' : 'invisible'"
      *matRowDef="let el; columns: ['show-details'];"></tr>

  </table>

</mat-card>
