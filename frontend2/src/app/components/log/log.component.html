
<mat-card
  *ngIf="current"
  class="item-details">

  <a
    mat-icon-button
    routerLink="/log"
    class="close">
    <mat-icon>close</mat-icon>
  </a>

  <span class="details-item">
    <strong>ID</strong>
    <span>{{current.id}}</span>
  </span>

  <span class="details-item">
    <strong>Created</strong>
    <span>{{current.created}}</span>
  </span>

  <span class="details-item">
    <strong>Type</strong>
    <span>{{current.type}}</span>
  </span>

  <span class="details-item full-width">
    <strong>Content</strong>
    <span>{{current.content}}</span>
  </span>

  <span *ngIf="current.exception" class="details-item full-width">
    <strong>Exception</strong>
    <span>{{current.exception}}</span>
  </span>

</mat-card>

<mat-form-field class="fill-width">

  <mat-label>Filter ...</mat-label>

  <input
    matInput
    placeholder="Filter ..."
    type="text"
    autocomplete="off"
    [formControl]="filterFormControl">

  <mat-icon
    matSuffix
    *ngIf="filterFormControl.value.trim() !== ''"
    class="button"
    matTooltip="Clear filter"
    (click)="clearFilter()">clear</mat-icon>

</mat-form-field>

<table
  mat-table
  [dataSource]="items"
  multiTemplateDataRows>

  <ng-container matColumnDef="when">
    <th
      class="minimalistic-col"
      mat-header-cell
      *matHeaderCellDef>When</th>
    <td
      class="minimalistic-col"
      mat-cell
      *matCellDef="let el">{{el.created | since}}</td>
  </ng-container>

  <ng-container matColumnDef="type">
    <th
      class="minimalistic-col"
      mat-header-cell
      *matHeaderCellDef>Type</th>
    <td
      (click)="setFilter(el.type)"
      class="minimalistic-col clickable-col"
      mat-cell
      *matCellDef="let el">{{el.type}}</td>
  </ng-container>

  <ng-container matColumnDef="content">
    <th
      mat-header-cell
      *matHeaderCellDef>Content</th>
    <td
      (click)="setFilter(el.content)"
      class="clickable-col"
      mat-cell
      *matCellDef="let el">{{el.content}}</td>
  </ng-container>

  <ng-container matColumnDef="details">
    <th
      class="button-col"
      mat-header-cell
      *matHeaderCellDef>Details</th>
    <td
      class="button-col"
      mat-cell
      *matCellDef="let el">
      <button
        (click)="toggleDetails(el)"
        mat-button>
        Details
      </button>
    </td>
  </ng-container>

  <ng-container matColumnDef="show-details">
    <td
      mat-cell
      *matCellDef="let el"
      colspan="4">
      <div
        class="details-sheet"
        *ngIf="shouldDisplayDetails(el)">

        <span class="details-item">
          <strong>ID</strong>
          <span>{{el.id}}</span>
        </span>

        <span class="details-item">
          <strong>Created</strong>
          <span>{{el.created}}</span>
        </span>

        <span class="details-item">
          <strong>Type</strong>
          <span>{{el.type}}</span>
        </span>

        <span class="details-item full-width">
          <strong>Content</strong>
          <span>{{el.content}}</span>
        </span>

        <span *ngIf="el.exception" class="details-item full-width">
          <strong>Exception</strong>
          <span>{{el.exception}}</span>
        </span>

        <a
          mat-icon-button
          class="id-link"
          matTooltip="Link to item"
          [routerLink]="'/log/' + el.id">
          <mat-icon>link</mat-icon>
        </a>

      </div>
    </td>
  </ng-container>

  <tr
    mat-header-row
    *matHeaderRowDef="displayedColumns"></tr>

  <tr
    mat-row
    [ngClass]="shouldDisplayDetails(el) ? 'display-details' : ''"
    *matRowDef="let el; columns: displayedColumns;"></tr>

  <tr
    mat-row
    [ngClass]="getClassForDetails(el)"
    *matRowDef="let el; columns: ['show-details'];"></tr>

</table>

<mat-paginator
  #paginator
  [class]="count > 25 ? '' : 'invisible'"
  [length]="count"
  pageSize="10"
  showFirstLastButtons="true"
  (page)="paged($event)"
  [pageSizeOptions]="[5,10,25,50]">
</mat-paginator>
